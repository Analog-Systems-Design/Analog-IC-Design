<!DOCTYPE HTML>
<html>
<head>
    <title>AnalogICDesign_By_HishamElreedy</title>
    <link href="https://fonts.googleapis.com/css?family=Voces" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/common.css"/>
  </head>
<body>
    <div class="toc" data-toc="h1, h2, h3, h4, h5">
    </div>
    <div class="toc right">
    </div>
    <div id="wrapper">
    <h1 id="last" data-toc-title="Custom subsub-heading">1. Mosfet Large & Small Signal Model</h1>
    We neglected short channel effect  & large VDS effect by using large L=1um and small vds=250mV and we also neglected bodyeffect by grounding the source
    <h2>1.1.Schematic</h2>
    <figure>
        <img src="images/Mosfet_Tsmc_130nm.png"/>
        <figcaption>Fig1.Tsmc_130nm_Schematic</figcaption>
    </figure>
    <h2>1.2. ID-Vs-VDS</h2>
    <figure>
        <img src="images/IdVsVDS.png" width="100%" height="100%"/>
        <caption><center>Id Vs Vds for Vgs=800mV</center></caption>
    </figure>
    <h2>1.3. TransConductance</h2>
    <figure>
        <img src="images/transconductance1.png"/>
        <caption><center>Credits: Dr. Hesham Omran<center></caption>
    </figure>
    <figure>
    <img src="images/IdVsVGS.png"/>
    <caption><center>ID Vs VGS</center></caption>
    </figure>
    <figure>
        <img src="images/gmcalculation.png"/>
        <caption><center>ID vs VGS and marking our operating point VGS=800mV</center></caption>
    </figure>
    <p>
    to calculate gm as our small signal was of 1mV amplitude 
    so X2=VGS+1mV, Y2=I(X2) and X1=VGS-1mV, Y1=I(X1) 
    and then gm=dI/dVGS = dY/dx = 5.1e-5 mhos
    </p>
    <figure>
        <img src="images/transconductance2.png"/>
        <caption><center>Credits: prof. Hesham Omran<center></caption>
    </figure>
    <p>
        Our output resistance upper bound is controlled by the value of ro so we can't increase rout than ro where we can find value of ro from simulation with name of gds where gds=1/ro like in figure below
    </p>
    <figure>
        <img src="images/gainupperbound.png"/>
        <caption><center>gds=2.433e-S==>ro=23.523Kohms</center></caption>
    </figure>
    <figure>
        <img src="images/increasingro.png"/>
        <caption><center>effect of increasing ro</center></caption>
        <caption><center><em>Credits: Prof. Hesham Omran</em></caption>
    </figure>
    <p>
    so we cannot increase our Rout more than 23.523Kohms and also we cannot increase Vds very much to increase ro because this will lead to gate loses its control over the drain current
    </p>
    <p>
    We can model our work above by this model in figure below
    </p>
    <figure>
    <img src="images/lowfreqsmallsignalmodel.png"/>
    <caption><center><em>Credits: Prof. Hesham Omran</em></caption>
    </figure>
    <h2>1.3. Short Channel Effects</h2>
    <figure>
    <img src="images/shortchanneleffects.png"/>
    <caption><center><em>Credits: Prof. Hesham Omran</em></caption>
    </figure>
    <p>
    Short Channel effects changes the relation between Mosfet drain current and VGS as in case of long channel we use the famous quadratic equation where if we derive transconductance from this equation we find that it is linear which means that it increases with VGS.<br/>
    While in case of short channel the relation between mosfet drain current and VGS becomes linear which means that if we drive transconductance we will find that it is of constant value.
    </p>
    <figure>
        <img src="images/shortchanneleffectsro.png"/>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <p>
    short channel effect affects the value of ro where it increases very much in this case which leads to high gain but Vgs loses control
    </p>
    <h1>2. Basic Amplifier Stages</h1>
    <p>
    we have three basic amplifier toplogies which are:
    <ul>
    <li>Common Source(CS): which acts as Voltage and current amplifier if we inject the signal from the gate and probing on Drain. where source is <mark>common</mark> between Drain and Gate</li>
    <li>Common Gate(CG): which acts as Voltage amplifier and Current Buffer, Buffer means amplifier of gain=1</li>
    <li>Common Drain(CD) or Source Follower(SF)</li>
    </ul>
    </p>
    <figure>
        <img src="images/basicamplifierstages/basicmosfetamplifiertopologies.png"/>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <h3>2.1. Amplifier Analysis Steps</h3>
    <figure>
        <img src="images/basicamplifierstages/amplifieranalysissteps.png"/>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <p>
    <ol>
    <li>DC analysis: to calculate DC operating point to check operation of mosfet in saturation (VDS>Vov)</li>
    <li>Calculate small signal parameters(gm,ro)</li>
    <li>Determine Amplifier Parameters(Rin, Rout, Av, Ai)</li>
    </ol>
    </p>
    <figure>
        <img src="images/basicamplifierstages/largeandsmallsignalanalysis.png"/>
        <caption><center>analysis types</caption>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <p>
        Let's summarize all types of analysis to study amplifier parameters,
        we have two types of analysis whether you are doing it by hand or on
        simulator like cadence spectre simulator.
    </p>
        <h4>2.1.1. Large Signal Analysis</h4>
        <ol>
            <li>Voltage Gain</li>
            <li>Current Gain</li>
            <li>Input Resistance</li>
            <li>Output Resistance</li>
            <li>Bandwidth</li>
        </ol>
        <h4>2.1.2 Small Signal Analysis</h4>
        <ol>
            <li>Bias Point</li>
            <li>Signal Swing</li>
            <li>Distortion</li>
        </ol>
    <h4>2.1.3. Direct Analysis on Schematic</h4>
    <figure>
        <img src="images/basicamplifierstages/directanalysisonschematic.png"/>
        <caption><center><em>Credits: Prof. Hisham Omran</em></caption>
    </figure>
     <p>
       We can simplify our solution instead of every time removing every transistor and
       draw its small signal model in order to deal with very large circuits that contains
       alot of mos transistors. so first we can remove the vccs gmVgs & gmVbs and add them
       and put them of mosfet drain branch.<br/>
       to simplify more, we found that in most cases gate node is grounded when we are calculating
       small signal model and also we always make the bulk grounded to neglect body effect so that means
       that Vgs=Vbs so we can gm & gmb together in a single gm so delta_Id=(gm+gmb)delta_Vgs
     </p>
     <figure>
        <img src="images/basicamplifierstages/directanalysisonschematic2.png"/>
        <caption><center><em>Credits: Prof. Hisham Omran</em></caption>
    </figure> 
    <h4>2.1.4. Common Approximations we usually use:</h4>
    <p>
        intrinsic gain >>>1 because it is the max gain we can reach and these 
        approximations are relative for example you can find (1/gm)~=100Kohms
        which is very large but you will find also that ro=10Mohms thats why I said
        that approximations are relative 
    </p>
    <figure>
        <center><img src="images/basicamplifierstages/commonapproximations.png"/></center>
        <caption><center><em>Credits: Prof. Hisham Omran</em></caption>
    </figure>
    <h4>2.1.5. Rin/Rout Shortcuts</h4>
    <p>
        
    </p>
    <h3>2.2. Common Source Amplifier</h3>
    <p>
        Common Source Amplifier Parameters:
        </p>
        <figure>
            <img src="images/basicamplifierstages/commonsourceamplifier.png"/>
            <caption><center>Common Source Amplifier Parameters</caption>
            <caption><center><em>credits:Prof. Hesham Omran</em></caption>
        </figure>
         <p>
            Remember that we are using the amplifier to amplify Vsig not Vin.<br/>
            which corresponds to Vsignal.
         </p>
         <h4>2.2.1 Case 1. Rout=Inf. using Ideal Current Source </h4> 
         <h5>2.2.1.1 Theory</h5>
         <figure>
            <img src="images/basicamplifierstages/maximumgain.png"/>
            <caption><center>Common Source Amplifier Parameters</caption>
            <caption><center><em>credits:Prof. Hesham Omran</em></caption>
        </figure>
         <p>
            Intrinsic gain means maximum gain which I can obtain from a 
            single transistor
         </p>
         <figure>
            <img src="images/basicamplifierstages/smallsignalanalysiscommonsourcenorout.png"/>
            <caption><center><em>credits:Prof. Hesham Omran</em></caption>
        </figure>
         <p>
            small signal analysis with rout=inf. by using ideal current source, first item you start 
            to debug in simulation is the bias point because all preceding parameters depend on it
         </p>
         <h5>2.2.1.2 simulation</h5>
         <figure>
            <img src="images/basicamplifierstages/smallsignalanalysiscommonsourcenoroutsim.png"/>
            <caption><center><em>Credits: Eng. Hisham Elreedy</em></caption>
        </figure>
         <p>
            you wil find vout(red curve) is larger than vin and also of phase difference of pi
            when I bias with current source I no longer need to adjust Vds and worry about its effect on
            gate voltage for losing control over the electron channel
         </p>
         <h5>2.2.1.3 Hand Analysis</h5>
         <p>
            First draw current branch on mosfet drain branch and draw ro in parallel with Vds
            and vbs connect it to ground away from the circuit as in figure below
        </p>
         <figure>
            <img src="images/basicamplifierstages/commonsourceanalysis.png"/>
            <caption><center><em>Credits: prof. Hesham Omran</em></caption>
        </figure>
        <p>
            Second combine gm*vgs and gmb*vbs because gate is grounded and then combine them
            in a single gm*vgs and calculate vout by applying kvl on the loop between vout and gnd
            to obtain vout like in figure below which is equal to Vout=-(gm*Vgs)*ro and vin = Vgs
            then we can obtain voltage gain(Av)=Vout/Vin=-gm*ro which demonstrates the results
            that we obtained in the simulation 
        </p>
         <figure>
            <img src="images/basicamplifierstages/commonsourceanalysis2.png"/>
            <caption><center><em>Credits: prof. Hesham Omran</em></caption>
        </figure>
        <figure>
            <img src="images/basicamplifierstages/commonsourceanalysis3.png"/>
            <caption><center><em>Credits: prof. Hesham Omran</em></caption>
        </figure>
    
<h4>2.2.2 Case 2: using finite drain resistance </h4>
    <figure>
        <img src="images/basicamplifierstages/currentsourcegainth.png"/>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <figure>
        <img src="images/basicamplifierstages/currentsourcegainth2.png"/>
        <caption><center><em>credits:Prof. Hesham Omran</em></caption>
    </figure>
    <figure>
        <img src="images/basicamplifierstages/currentsourcegain.png"/>
        <caption><center>Common source Gain</caption>
    </figure>
    <p>
    I removed dc value when plotting output by subtracting the output voltage from the average of the total signal using cadence calculator, you will find that they change in phase to explain this:<br />
    when <mark>vgs increases drain</mark> current increases which affect vout precedingly as voltage drop on resistance increases which makes <mark>Vout decreases</marK> thats why they have phase difference of pi==(180 degrees)
    </p>
    <figure>
        <img src="images/basicamplifierstages/smallsignalanalysiscommonsourceroutsim.png"/>
        <caption><center><em>Credits: Eng. Hisham Elreedy</em></caption>
    </figure>
     <p>
        vds problem starts to rise here when we put finite resistance on the drain where it made
        the amplifier with very low gain and when we increase Rout we can't increase it than ro=23.523Kohms
     </p>

    </div>
    <script src="js/common.js"></script>
    <script>$('#toc').toc();</script>
</body>
</html>